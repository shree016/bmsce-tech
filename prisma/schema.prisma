generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

/* ---------------------------
   QUESTION MODEL
---------------------------- */
model Question {
  id          String     @id @default(cuid())
  question    String
  type        String
  audience    String
  isAnonymous Boolean    @default(false)   // can remove later if unused
  requireName Boolean    @default(false)   // can remove later
  createdAt   DateTime   @default(now())
  responses   Response[]

  @@index([createdAt])
}

/* ---------------------------
   RESPONSE MODEL
---------------------------- */
model Response {
  id          String   @id @default(cuid())
  questionId  String
  answer      String
  email       String                  // ALWAYS required
  submittedAt DateTime @default(now())

  question Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([questionId, email])       // One email â†’ One response per question
  @@index([questionId])
  @@index([submittedAt])
}

/* ---------------------------
   STUDENT MODEL
---------------------------- */
model Student {
  id      String @id @default(cuid())
  name    String
  usn     String @unique
  section String
  email   String @unique

  @@index([section])
  @@index([usn])
}
